# upstream-merge-tool

Automatically merge upstream changes while preserving custom code with intelligent conflict resolution.

## ğŸ“ƒ æ¦‚è¦

`upstream-merge-tool` ã¯ã€ãƒ•ã‚©ãƒ¼ã‚¯ã—ãŸãƒªãƒã‚¸ãƒˆãƒªã‚„ãƒ­ãƒ¼ã‚«ãƒ«ä¿®æ­£ã‚’å«ã‚€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€ä¸Šæµï¼ˆUpstreamï¼‰ã‹ã‚‰ã®å¤‰æ›´ã‚’è‡ªå‹•çš„ã«ãƒãƒ¼ã‚¸ã™ã‚‹éš›ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ã‚’ä¿æŒã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚·ãƒŠãƒªã‚ªã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚

**ä¸»ãªç‰¹å¾´ï¼š**
- âœ… è‡ªå‹•ç«¶åˆæ¤œå‡ºã¨æ¡ä»¶ä»˜ãè‡ªå‹•è§£æ±º
- âœ… ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚«ãƒ¼ï¼ˆ`// CUSTOM-CODE-START` ï½ `// CUSTOM-CODE-END`ï¼‰å¯¾å¿œ
- âœ… Upstream ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡æ©Ÿèƒ½ï¼ˆã‚¿ã‚°ã€package.jsonã€æ‰‹å‹•æŒ‡å®šã«å¯¾å¿œï¼‰
- âœ… 3 ã¤ã®ã‚·ãƒŠãƒªã‚ªã«å¯¾å¿œï¼š
  - **No Conflict**: ç«¶åˆãªã—ã®é€šå¸¸ãƒãƒ¼ã‚¸
  - **Auto-Resolvable**: è‡ªå‹•è§£æ±ºå¯èƒ½ãªç«¶åˆ
  - **Manual Resolution**: æ‰‹å‹•è§£æ±ºãŒå¿…è¦ãªç«¶åˆ
- âœ… è©³ç´°ãªãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å«ã‚€ï¼‰
- âœ… Node.js / npm / yarn / Bun ã«å¯¾å¿œ
- âœ… 213 å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ»çµ±åˆãƒ»E2Eï¼‰ã§å®Œå…¨æ¤œè¨¼

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### å¿…è¦ãªç’°å¢ƒ

- **Git**: ãƒãƒ¼ã‚¸æ“ä½œã«å¿…é ˆ
- **Node.js** v18.0.0+ï¼ˆnpm/yarn ã®å ´åˆï¼‰
  ã¾ãŸã¯
- **Bun** v1.2.15+ï¼ˆBun ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®å ´åˆï¼‰

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# npm ã‚’ä½¿ã†å ´åˆ
npm install

# yarn ã‚’ä½¿ã†å ´åˆ
yarn install

# Bun ã‚’ä½¿ã†å ´åˆ
bun install
```

### 2. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `config.json` ã‚’ä½œæˆã—ã¾ã™ï¼š

```json
{
  "upstream_repository_name": "upstream",
  "upstream_branch_name": "main",
  "last_merged_upstream_commit": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "custom_code_marker": {
    "start": "// CUSTOM-CODE-START",
    "end": "// CUSTOM-CODE-END"
  }
}
```

**è¨­å®šé …ç›®ã®èª¬æ˜ï¼š**

| é …ç›® | èª¬æ˜ | ä¾‹ |
|------|------|-----|
| `upstream_repository_name` | ä¸Šæµãƒªãƒã‚¸ãƒˆãƒªã®ãƒªãƒ¢ãƒ¼ãƒˆå | `upstream` |
| `upstream_branch_name` | ä¸Šæµãƒ–ãƒ©ãƒ³ãƒå | `main` ã¾ãŸã¯ `master` |
| `last_merged_upstream_commit` | æœ€å¾Œã«ãƒãƒ¼ã‚¸ã—ãŸä¸Šæµã‚³ãƒŸãƒƒãƒˆ SHA | `a1b2c3d...` (40 æ–‡å­—) |
| `last_merged_upstream_version` | æœ€å¾Œã«ãƒãƒ¼ã‚¸ã—ãŸä¸Šæµãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ | `v1.2.3` |
| `upstream_version_tracking` | ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ | ä¸‹è¨˜å‚ç…§ |
| `custom_code_marker.start` | ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰é–‹å§‹ãƒãƒ¼ã‚«ãƒ¼ | `// CUSTOM-CODE-START` |
| `custom_code_marker.end` | ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰çµ‚äº†ãƒãƒ¼ã‚«ãƒ¼ | `// CUSTOM-CODE-END` |

#### ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’è¿½è·¡ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šåˆ†ã‹ã‚Šã‚„ã™ã„ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼š

```json
{
  "upstream_version_tracking": {
    "enabled": true,
    "type": "tag",
    "value": "v*"
  }
}
```

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ã‚¿ã‚¤ãƒ—ï¼š**

- **`tag`**: Git ã‚¿ã‚°ã‹ã‚‰æœ€æ–°ã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•å–å¾—ï¼ˆæ¨å¥¨ï¼‰
- **`package`**: Upstream ã® `package.json` ã‹ã‚‰ version ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å–å¾—
- **`manual`**: æ‰‹å‹•ã§æŒ‡å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³æ–‡å­—åˆ—ã‚’ä½¿ç”¨

**ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‹•ä½œï¼š**
- Primary æ–¹å¼ãŒå¤±æ•—ã—ãŸå ´åˆã€ä»–ã®æ–¹æ³•ã‚’è‡ªå‹•çš„ã«è©¦è¡Œ
- ã™ã¹ã¦ã®æ–¹æ³•ãŒå¤±æ•—ã—ãŸå ´åˆã¯ã€ã‚³ãƒŸãƒƒãƒˆ ID ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ãŒã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã‚‚ã€ãƒãƒ¼ã‚¸å‡¦ç†ã¯ç¶™ç¶š

### 3. ãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡Œ

```bash
# npm
npm run start

# yarn
yarn start

# Bun
bun run index.ts
```

## ğŸ“‹ è¨­å®šã®è©³ç´°ã‚¬ã‚¤ãƒ‰

### Upstream ãƒªãƒ¢ãƒ¼ãƒˆã®è¨­å®š

```bash
# ç¾åœ¨ã®ãƒªãƒ¢ãƒ¼ãƒˆç¢ºèª
git remote -v

# ä¸Šæµãƒªãƒ¢ãƒ¼ãƒˆãŒãªã„å ´åˆã¯è¿½åŠ 
git remote add upstream https://github.com/original-repo/repository.git

# ä¸Šæµã‹ã‚‰ã®æœ€æ–°æƒ…å ±ã‚’å–å¾—
git fetch upstream
```

### ã‚³ãƒŸãƒƒãƒˆ SHA ã®ç¢ºèª

```bash
# ä¸Šæµã®æœ€æ–°ã‚³ãƒŸãƒƒãƒˆ SHA ã‚’ç¢ºèª
git log upstream/main --oneline -1

# ã¾ãŸã¯ã€ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆ SHA ã‚’ç¢ºèª
git rev-parse upstream/main
```

### ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚«ãƒ¼ã®ä½¿ç”¨ä¾‹

```typescript
// app.ts

export const config = { version: '2.0.0' };

// CUSTOM-CODE-START
// ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ã¿ä½¿ç”¨ã™ã‚‹è¨­å®š
export const LOCAL_SETTINGS = {
  debug: true,
  apiUrl: 'http://localhost:3000'
};
// CUSTOM-CODE-END

export function initialize() {
  console.log('Initializing...');
}
```

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ã®è¨­å®šä¾‹

#### ä¾‹ 1: Git ã‚¿ã‚°ã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰

```json
{
  "upstream_repository_name": "upstream",
  "upstream_branch_name": "main",
  "last_merged_upstream_commit": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "last_merged_upstream_version": "v1.2.0",
  "upstream_version_tracking": {
    "enabled": true,
    "type": "tag"
  },
  "custom_code_marker": {
    "start": "// CUSTOM-CODE-START",
    "end": "// CUSTOM-CODE-END"
  }
}
```

**çµæœï¼š** ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆã«ã€Œv1.2.0 â†’ v1.3.0ã€ã®ã‚ˆã†ã«è¡¨ç¤º

#### ä¾‹ 2: package.json ã‹ã‚‰è‡ªå‹•å–å¾—

```json
{
  "upstream_repository_name": "upstream",
  "upstream_branch_name": "main",
  "last_merged_upstream_commit": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "upstream_version_tracking": {
    "enabled": true,
    "type": "package"
  },
  "custom_code_marker": {
    "start": "// CUSTOM-CODE-START",
    "end": "// CUSTOM-CODE-END"
  }
}
```

**çµæœï¼š** Upstream ã® package.json ã‹ã‚‰ version ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è‡ªå‹•æŠ½å‡º

#### ä¾‹ 3: æ‰‹å‹•æŒ‡å®š

```json
{
  "upstream_repository_name": "upstream",
  "upstream_branch_name": "main",
  "last_merged_upstream_commit": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "upstream_version_tracking": {
    "enabled": true,
    "type": "manual",
    "value": "release-2025-10-19"
  },
  "custom_code_marker": {
    "start": "// CUSTOM-CODE-START",
    "end": "// CUSTOM-CODE-END"
  }
}
```

**çµæœï¼š** æŒ‡å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³æ–‡å­—åˆ—ã‚’ãã®ã¾ã¾ä½¿ç”¨

#### ä¾‹ 4: ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ã‚’ç„¡åŠ¹åŒ–ï¼ˆå¾“æ¥ã®å‹•ä½œï¼‰

```json
{
  "upstream_repository_name": "upstream",
  "upstream_branch_name": "main",
  "last_merged_upstream_commit": "a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0",
  "upstream_version_tracking": {
    "enabled": false
  },
  "custom_code_marker": {
    "start": "// CUSTOM-CODE-START",
    "end": "// CUSTOM-CODE-END"
  }
}
```

**çµæœï¼š** ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã¯ä½¿ç”¨ã•ã‚Œãšã€æ—¢å­˜ã®ã‚³ãƒŸãƒƒãƒˆ ID ãƒ™ãƒ¼ã‚¹ã§å‹•ä½œ

## ğŸ¯ ä½¿ç”¨ã‚·ãƒŠãƒªã‚ª

### ã‚·ãƒŠãƒªã‚ª 1: ç«¶åˆãªã—

ä¸Šæµã®å¤‰æ›´ã¨ãƒ­ãƒ¼ã‚«ãƒ«ã®å¤‰æ›´ãŒåˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ã‚‹å ´åˆã€è‡ªå‹•çš„ã«ãƒãƒ¼ã‚¸ã•ã‚Œã¾ã™ã€‚

```bash
$ npm run start
[INFO] Starting upstream merge...
[INFO] Fetching from upstream...
[SUCCESS] Merge completed successfully
[REPORT] Total Conflicts: 0
```

### ã‚·ãƒŠãƒªã‚ª 2: è‡ªå‹•è§£æ±ºå¯èƒ½

ä¸ŠæµãŒå¤‰æ›´ã—ã¦ã„ãªã„éƒ¨åˆ†ã§ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚«ãƒ¼ã§å›²ã¾ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆã€è‡ªå‹•çš„ã«è§£æ±ºã•ã‚Œã¾ã™ã€‚

```
Upstream ã®å¤‰æ›´:   export const x = 1;
Local ã®å¤‰æ›´:      export const x = 1;
                   // CUSTOM-CODE-START
                   const custom = 'value';
                   // CUSTOM-CODE-END

çµæœ:              è‡ªå‹•è§£æ±º âœ“ (ãƒãƒ¼ã‚«ãƒ¼ãŒå‰Šé™¤ã•ã‚Œã‚‹)
```

### ã‚·ãƒŠãƒªã‚ª 3: æ‰‹å‹•è§£æ±ºãŒå¿…è¦

ä¸Šæµã¨ãƒ­ãƒ¼ã‚«ãƒ«ã®ä¸¡æ–¹ãŒåŒã˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¤‰æ›´ã—ãŸå ´åˆã€æ‰‹å‹•ã§ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦è§£æ±ºã—ã¾ã™ã€‚

```
Upstream ã®å¤‰æ›´:   export const x = 1;
Local ã®å¤‰æ›´:      export const x = 999;

çµæœ:              æ‰‹å‹•è§£æ±º âœ— (ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç¢ºèªã—ã¦è§£æ±º)
```

## ğŸ“Š ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®è§£é‡ˆ

ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œå¾Œã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¬ãƒãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   Upstream Merge Report                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Status: SUCCESS / FAILURE
Total Conflicts: X

Auto-Resolved (X files):
âœ“ src/config/settings.ts
âœ“ src/utils/helpers.ts

Manual Resolution Required (X files):
âœ— src/main.ts
âœ— src/api/client.ts

Execution Time: 1.234s
```

**ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èª¬æ˜ï¼š**
- **Status**: å…¨ä½“çš„ãªãƒãƒ¼ã‚¸çµæœ
- **Total Conflicts**: æ¤œå‡ºã•ã‚ŒãŸç«¶åˆæ•°
- **Auto-Resolved**: è‡ªå‹•çš„ã«è§£æ±ºã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
- **Manual Resolution Required**: æ‰‹å‹•å¯¾å¿œãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«

## ğŸ§ª ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
bun test

# ç‰¹å®šã®ã‚«ãƒ†ã‚´ãƒªã®ã¿å®Ÿè¡Œ
bun test src/__tests__/unit          # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
bun test src/__tests__/integration   # çµ±åˆãƒ†ã‚¹ãƒˆ
bun test src/__tests__/e2e           # E2E ãƒ†ã‚¹ãƒˆ

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ
bun test src/__tests__/unit/config-manager.test.ts

# ãƒ†ã‚¹ãƒˆçµæœã®çµ±è¨ˆ
bun test --summary
```

**ãƒ†ã‚¹ãƒˆçµ±è¨ˆï¼ˆ2025-10-19ï¼‰:**
- âœ… ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ: 150 å€‹
- âœ… çµ±åˆãƒ†ã‚¹ãƒˆ: 26 å€‹
- âœ… E2E ãƒ†ã‚¹ãƒˆ: 37 å€‹
- **åˆè¨ˆ: 213 å€‹ãƒ†ã‚¹ãƒˆ PASS**

## ğŸ”§ åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰

```bash
# å®Ÿè¡Œ
npm run start          # Node.js/npm ã§å®Ÿè¡Œ
npm run start:bun      # Bun ã§å®Ÿè¡Œ
npm run dev            # ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰

# ãƒ†ã‚¹ãƒˆ
npm run test           # ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:coverage  # ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

# ãƒ“ãƒ«ãƒ‰ï¼ˆBun å¿…é ˆï¼‰
npm run build          # ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒã‚¤ãƒŠãƒªç”Ÿæˆ
```

## ğŸ§ª Run Tests

```bash
# Run all tests
bun test

# Run unit tests only
bun test src/__tests__/unit

# Run integration tests only
bun test src/__tests__/integration

# Run E2E tests only
bun test src/__tests__/e2e

# Run specific test file
bun test src/__tests__/unit/config-manager.test.ts

# Test coverage report
npm run test:coverage
```

**ãƒ†ã‚¹ãƒˆå®Ÿç¸¾ï¼ˆ2025-10-19ï¼‰:**

| ãƒ†ã‚¹ãƒˆã‚¿ã‚¤ãƒ— | ãƒ†ã‚¹ãƒˆæ•° | çµæœ |
|-------------|---------|------|
| ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ | 145 | âœ… å…¨ã¦ PASS |
| çµ±åˆãƒ†ã‚¹ãƒˆ | 26 | âœ… å…¨ã¦ PASS |
| E2E ãƒ†ã‚¹ãƒˆ | 28 | âœ… å…¨ã¦ PASS |
| **åˆè¨ˆ** | **199** | **âœ… 100% PASS** |

**E2E ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª:**
- âœ… Scenario 1 (No Conflict): 6 å€‹ãƒ†ã‚¹ãƒˆ
- âœ… Scenario 2 (Auto-Resolvable): 6 å€‹ãƒ†ã‚¹ãƒˆ
- âœ… Scenario 3 (Manual Resolution): 7 å€‹ãƒ†ã‚¹ãƒˆ
- âœ… Error Cases: 9 å€‹ãƒ†ã‚¹ãƒˆ

## ğŸ’¡ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: "fatal: refusing to merge unrelated histories" ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

**åŸå› **: Upstream ãƒªãƒ¢ãƒ¼ãƒˆã¨ Local ãŒç•°ãªã‚‹ã‚³ãƒŸãƒƒãƒˆå±¥æ­´ã‚’æŒã£ã¦ã„ã‚‹

**è§£æ±ºç­–**: ã“ã®ã‚¨ãƒ©ãƒ¼ã¯æœ¬ãƒ„ãƒ¼ãƒ«å†…ã§è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ï¼ˆ`--allow-unrelated-histories` ãƒ•ãƒ©ã‚°ä½¿ç”¨ï¼‰

### Q: ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚«ãƒ¼ãŒå‰Šé™¤ã•ã‚Œãªã„

**åŸå› **: ãƒãƒ¼ã‚«ãƒ¼ã®å½¢å¼ãŒ `config.json` ã¨ä¸€è‡´ã—ã¦ã„ãªã„

**ç¢ºèªæ–¹æ³•**:
```bash
# config.json ã®ãƒãƒ¼ã‚«ãƒ¼å½¢å¼ã‚’ç¢ºèª
cat config.json | grep -A2 "custom_code_marker"

# ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å†…ã®ãƒãƒ¼ã‚«ãƒ¼ã¨æ¯”è¼ƒ
grep "CUSTOM-CODE" src/**/*.ts
```

### Q: ã‚³ãƒŸãƒƒãƒˆ SHA ãŒè¦‹ã¤ã‹ã‚‰ãªã„

**åŸå› **: `last_merged_upstream_commit` ã«ç„¡åŠ¹ãª SHA ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹

**è§£æ±ºç­–**:
```bash
# æœ‰åŠ¹ãªã‚³ãƒŸãƒƒãƒˆ SHA ã‚’ç¢ºèª
git log upstream/main --format=%H -n 10

# ä¸Šæµã®ãƒ–ãƒ©ãƒ³ãƒãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
git branch -r | grep upstream
```

## ğŸ› ï¸ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¾‹

### åŸºæœ¬çš„ãªä½¿ç”¨ãƒ•ãƒ­ãƒ¼

```bash
# 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
git clone <your-forked-repo>
cd upstream-merge-tool

# 2. ä¸Šæµãƒªãƒ¢ãƒ¼ãƒˆã‚’è¿½åŠ 
git remote add upstream <original-repo-url>
git fetch upstream

# 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
# config.json ã‚’ç·¨é›†ï¼ˆä¸Šè¨˜ã®ã‚¬ã‚¤ãƒ‰ã‚’å‚ç…§ï¼‰

# 4. ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œ
npm run start

# 5. ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèª
# - Auto-Resolved: ä½•ã‚‚ã—ãªãã¦ OK
# - Manual Resolution Required: æ‰‹å‹•ã§ãƒãƒ¼ã‚¸ã‚’å®Œäº†
```

### æ‰‹å‹•è§£æ±ºã®æ‰‹é †

```bash
# 1. ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œå¾Œã€ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆã§ç«¶åˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèª

# 2. ç«¶åˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
nano src/conflicted-file.ts

# 3. Git ã®ç«¶åˆãƒãƒ¼ã‚«ãƒ¼ã‚’æ‰‹å‹•ã§è§£æ±º
# <<<<<<< HEAD
# ======= 
# >>>>>>> upstream/main
# ã“ã®éƒ¨åˆ†ã‚’ç·¨é›†ã—ã¦è§£æ±º

# 4. ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã—ã¦ã‚³ãƒŸãƒƒãƒˆ
git add src/conflicted-file.ts
git commit -m "Resolve merge conflict with upstream"

# 5. å¿…è¦ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚«ãƒ¼ã‚’è¿½åŠ 
```

## ğŸ“š è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

è¨­å®šæ–¹æ³•ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ã¤ã„ã¦è©³ã—ãã¯ã€ä»¥ä¸‹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

- [`RUNTIME_SETUP.md`](./RUNTIME_SETUP.md) - ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç’°å¢ƒã®è©³ç´°è¨­å®š
- `docs/02_requirements/features/` - æ©Ÿèƒ½è¦ä»¶æ›¸
- `docs/03_design/` - ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `docs/04_implementation/` - å®Ÿè£…ã‚¬ã‚¤ãƒ‰
- `docs/05_testing/` - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä»•æ§˜

## ğŸ”§ Available Scripts

```bash
# å®Ÿè¡Œ
npm run start          # Node.js ã§å®Ÿè¡Œ
npm run start:bun      # Bun ã§å®Ÿè¡Œ
npm run dev            # ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰

# ãƒ†ã‚¹ãƒˆ
npm run test           # ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:coverage  # ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ

# ãƒ“ãƒ«ãƒ‰ï¼ˆBun å¿…é ˆï¼‰
npm run build          # ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ãƒã‚¤ãƒŠãƒªç”Ÿæˆ
```

## ğŸ“¦ Project Structure

```
upstream-merge-tool/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                     # ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ config/ConfigManager.ts     # è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ git/GitService.ts           # Git æ“ä½œ
â”‚   â”œâ”€â”€ conflict/ConflictResolver.ts # ç«¶åˆè§£æ±º
â”‚   â”œâ”€â”€ report/ReportGenerator.ts   # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
â”‚   â”œâ”€â”€ logger/Logger.ts            # ãƒ­ã‚®ãƒ³ã‚°
â”‚   â”œâ”€â”€ types/                      # TypeScript å‹å®šç¾©
â”‚   â”œâ”€â”€ utils/                      # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ __tests__/                  # ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ
â”‚       â”œâ”€â”€ unit/                   # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ (145 å€‹)
â”‚       â”œâ”€â”€ integration/            # çµ±åˆãƒ†ã‚¹ãƒˆ (26 å€‹)
â”‚       â””â”€â”€ e2e/                    # E2E ãƒ†ã‚¹ãƒˆ (28 å€‹)
â”œâ”€â”€ config.json                      # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ package.json                     # npm è¨­å®š
â”œâ”€â”€ tsconfig.json                    # TypeScript è¨­å®š
â”œâ”€â”€ docs/                           # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ 02_requirements/            # è¦ä»¶å®šç¾©
â”‚   â”œâ”€â”€ 03_design/                  # è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ 04_implementation/          # å®Ÿè£…è¨ˆç”»
â”‚   â””â”€â”€ 05_testing/                 # ãƒ†ã‚¹ãƒˆä»•æ§˜
â””â”€â”€ README.md                        # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

## âœ¨ Features

- âœ… è‡ªå‹•ä¸Šæµãƒãƒ¼ã‚¸
- âœ… ã‚¹ãƒãƒ¼ãƒˆç«¶åˆæ¤œå‡º
- âœ… ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ¼ãƒ‰ãƒãƒ¼ã‚«ãƒ¼å¯¾å¿œ
- âœ… æ¡ä»¶ä»˜ãè‡ªå‹•è§£æ±º
- âœ… Upstream ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡æ©Ÿèƒ½
- âœ… è©³ç´°ãªãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å«ã‚€ï¼‰
- âœ… Node.js ã¨ Bun ä¸¡å¯¾å¿œ
- âœ… 213 å€‹ã®åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆ (100% PASS)

## ğŸ”„ ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡æ©Ÿèƒ½ã‚¬ã‚¤ãƒ‰

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ã¨ã¯

ä¸Šæµãƒªãƒã‚¸ãƒˆãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’è‡ªå‹•çš„ã«å–å¾—ãƒ»è¿½è·¡ã™ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Œv1.2.0 ã‹ã‚‰ v1.3.0 ã¸ã®ãƒãƒ¼ã‚¸ã€ã®ã‚ˆã†ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦ã‚ã‹ã‚Šã‚„ã™ã„ãƒ¬ãƒãƒ¼ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### å‹•ä½œä»•æ§˜

#### å„ªå…ˆé †ä½

1. **ã‚¿ã‚°ã‹ã‚‰å–å¾—**: Git ã‚¿ã‚°ã®ä¸­ã‹ã‚‰æœ€æ–°ã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆv1.2.3 å½¢å¼ï¼‰ã‚’è‡ªå‹•æŠ½å‡º
2. **package.json ã‹ã‚‰å–å¾—**: Upstream ãƒªãƒã‚¸ãƒˆãƒªã® `package.json` ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ version ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŠ½å‡º
3. **æ‰‹å‹•æŒ‡å®š**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ç›´æ¥æŒ‡å®šã—ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³æ–‡å­—åˆ—ã‚’ä½¿ç”¨
4. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ã™ã¹ã¦ã®æ–¹æ³•ãŒå¤±æ•—ã—ãŸå ´åˆã€æ—¢å­˜ã®ã‚³ãƒŸãƒƒãƒˆ ID ã‚’ä½¿ç”¨

#### å¤±æ•—è€æ€§

- ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—ãŒã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã‚‚ã€**ãƒãƒ¼ã‚¸å‡¦ç†ã¯ç¶™ç¶š**
- è­¦å‘Šãƒ­ã‚°ã‚’å‡ºåŠ›ã—ã€ã‚³ãƒŸãƒƒãƒˆ ID ã‚’ä»£æ›¿ã¨ã—ã¦ä½¿ç”¨
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡è¨­å®šãŒãªãã¦ã‚‚ã€**å¾Œæ–¹äº’æ›æ€§ã‚’ä¿è¨¼**ï¼ˆæ—¢å­˜ã® config.json ã¯ãã®ã¾ã¾ä½¿ç”¨å¯èƒ½ï¼‰

### ãƒãƒ¼ã‚¸ãƒ¬ãƒãƒ¼ãƒˆä¾‹

ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ã‚’æœ‰åŠ¹ã«ã—ãŸå ´åˆã€ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›ã«ä»¥ä¸‹ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ãŒå«ã¾ã‚Œã¾ã™ï¼š

```
============================================================
UPSTREAM MERGE TOOL REPORT
============================================================
Execution Time: 2025-10-19T00:14:02.089Z
Duration: 2s
Status: âœ“ SUCCESS

VERSION INFORMATION:
------------------------------------------------------------
Previous Version: v1.2.0
Current Version: v1.3.0
Source: tag

CONFLICT SUMMARY:
------------------------------------------------------------
Total Conflicts: 0
Auto-Resolved: 0
Manual Required: 0

============================================================
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—ãŒå¤±æ•—ã™ã‚‹å ´åˆ

```bash
# Git ã‚¿ã‚°ã®ç¢ºèª
git tag -l | grep "v"

# ç‰¹å®šã®ãƒªãƒ¢ãƒ¼ãƒˆã®ã‚¿ã‚°ã‚’ç¢ºèª
git ls-remote --tags upstream | grep "v"

# package.json ã®ç¢ºèª
git show upstream/main:package.json | jq '.version'
```

#### ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–

```json
{
  "upstream_version_tracking": {
    "enabled": false
  }
}
```

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **[ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](#-ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ)** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«å¾“ã£ã¦ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
2. **[è¨­å®šã®è©³ç´°ã‚¬ã‚¤ãƒ‰](#-è¨­å®šã®è©³ç´°ã‚¬ã‚¤ãƒ‰)** ã§ `config.json` ã‚’ä½œæˆ
3. **[ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡æ©Ÿèƒ½ã‚¬ã‚¤ãƒ‰](#-ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¿½è·¡æ©Ÿèƒ½ã‚¬ã‚¤ãƒ‰)** ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®è¨­å®šã‚’æ¤œè¨
4. **[ä½¿ç”¨ã‚·ãƒŠãƒªã‚ª](#-ä½¿ç”¨ã‚·ãƒŠãƒªã‚ª)** ã§è‡ªåˆ†ã®çŠ¶æ³ã«åˆã‚ã›ãŸæ–¹æ³•ã‚’ç¢ºèª
5. ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã—ã¦ãƒãƒ¼ã‚¸ã‚’å®Œäº†

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT

---

**é–‹ç™ºæƒ…å ±**: ã“ã®ãƒ„ãƒ¼ãƒ«ã¯å®Œå…¨ã«ãƒ†ã‚¹ãƒˆã•ã‚Œã€213 å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆãƒ»çµ±åˆãƒ»E2Eï¼‰ã§ 100% PASS ã—ã¦ã„ã¾ã™ã€‚

è©³ç´°ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼š
- **è¦ä»¶å®šç¾©**: `docs/02_requirements/features/upstream-version-tracking-requirements.md`
- **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ**: `docs/03_design/architecture/upstream-merge-tool-architecture.md`
- **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**: `docs/05_testing/test-cases/upstream-merge-tool-test-cases.md`
